{"version":3,"sources":["../../src/utils/index.js"],"names":["Utils","password","bcrypt","hashSync","genSaltSync","hashedPassword","compareSync","payload","jwt","sign","process","env","SECRET","expiresIn","token","verify"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AAEA;;;IAGMA,K;;;;;;;;;;AACJ;;;;;;iCAMoBC,Q,EAAU;AAC5B,aAAOC,qBAAOC,QAAP,CAAgBF,QAAhB,EAA0BC,qBAAOE,WAAP,CAAmB,CAAnB,CAA1B,CAAP;AACD;AAED;;;;;;;;;;oCAOuBH,Q,EAAUI,c,EAAgB;AAC/C,aAAOH,qBAAOI,WAAP,CAAmBL,QAAnB,EAA6BI,cAA7B,CAAP;AACD;AAED;;;;;;;;;kCAMqBE,O,EAAS;AAC5B,aAAOC,yBAAIC,IAAJ,CAASF,OAAT,EAAkBG,OAAO,CAACC,GAAR,CAAYC,MAA9B,EAAsC;AAAEC,QAAAA,SAAS,EAAE;AAAb,OAAtC,CAAP;AACD;AAED;;;;;;;;;;gCAOmBC,K,EAAO;AACxB,aAAON,yBAAIO,MAAJ,CAAWD,KAAX,EAAkBJ,OAAO,CAACC,GAAR,CAAYC,MAA9B,CAAP;AACD;;;;;eAEYZ,K","sourcesContent":["import bcrypt from 'bcryptjs';\nimport jwt from 'jsonwebtoken';\n\n/**\n * @description Utils controller Class\n */\nclass Utils {\n  /**\n   * hashPassword\n   * @description hashes a password\n   * @param { string } password\n   * @returns { string } hashed password\n   */\n  static hashPassword(password) {\n    return bcrypt.hashSync(password, bcrypt.genSaltSync(8));\n  }\n\n  /**\n   * comparePassword\n   * @description compares two passwords\n   * @param { String } password\n   * @param { String } hashedPassword\n   * @returns { Boolean } True or false\n   */\n  static comparePassword(password, hashedPassword) {\n    return bcrypt.compareSync(password, hashedPassword);\n  }\n\n  /**\n   * generateToken\n   * @description generates authentication token\n   * @param { Object } payload - { id, email }\n   * @returns { String } token\n   */\n  static generateToken(payload) {\n    return jwt.sign(payload, process.env.SECRET, { expiresIn: '2h' });\n  }\n\n  /**\n   * decodeToken\n   * @description decodes the token and returns the corresponding payload\n   * @param { String } token\n   * @returns { Object } payload - { id, email, isAdmin }\n   * @memberof Utils\n   */\n  static decodeToken(token) {\n    return jwt.verify(token, process.env.SECRET);\n  }\n}\nexport default Utils;\n"],"file":"index.js"}